name: ğŸš€ Test GitHub Actions

on:
  push:
    branches: [main, dev]
  pull_request:
    branches: [main, dev]
  workflow_dispatch: # Permet de dÃ©clencher manuellement depuis l'interface GitHub

jobs:
  test-actions:
    name: ğŸ§ª Test Basic Setup
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v5

      - name: âœ… Basic test
        run: |
          echo "ğŸ‰ GitHub Actions est bien configurÃ© !"
          echo "ğŸ“… Date: $(date)"
          echo "ğŸŒ¿ Branch: ${{ github.ref_name }}"
          echo "ğŸ‘¤ Actor: ${{ github.actor }}"
          echo "ğŸ¯ Event: ${{ github.event_name }}"

      - name: ğŸ“‚ Check project structure
        run: |
          echo "ğŸ“ Structure Ã  la racine :"
          ls -la
          echo ""
          echo "ğŸ“ Structure Cardoon :"
          ls -la Cardoon/ || echo "âŒ Dossier Cardoon non trouvÃ©"
          echo ""
          if [ -f "Cardoon/package.json" ]; then
            echo "âœ… package.json trouvÃ© dans Cardoon/"
          else
            echo "âŒ package.json non trouvÃ© dans Cardoon/"
          fi

  test-cardoon-setup:
    name: ğŸŸ¢ Test Cardoon Setup
    runs-on: ubuntu-latest

    defaults:
      run:
        working-directory: ./Cardoon

    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v5

      - name: ğŸŸ¢ Setup Node.js
        uses: actions/setup-node@v6
        with:
          node-version: "24"
          cache: "yarn"
          cache-dependency-path: "Cardoon/yarn.lock"

      - name: ğŸ“¦ Install dependencies
        run: yarn install --frozen-lockfile

      - name: ğŸ“‹ Show available scripts
        run: |
          echo "ğŸ“ Scripts disponibles :"
          yarn run
          echo ""
          echo "ğŸ“ Versions :"
          echo "Node: $(node --version)"
          echo "Yarn: $(yarn --version)"

      - name: âœ… Quick validation
        run: |
          echo "âœ… Installation successful!"
          echo "ğŸ“¦ node_modules exists: $([ -d node_modules ] && echo 'Yes' || echo 'No')"
