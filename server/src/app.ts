// app.js
import express from "express";
import connectDB from "./config/db.js";
import cardsRoutes from "./api/cards.js";

import { Request, Response } from "express";

import usersRoutes from "./api/users.js";
import userCardsRoutes from "./api/userCards.js";
import itemsRoutes from "./api/items.js";
import mistralRoutes from "./api/mistral.js";
import cors from "cors";
import bodyParser from "body-parser";
import dotenv from "dotenv";
import UserCard from "./models/UserCard.js";
import User from "./models/User.js";
import Card from "./models/Card.js";
import { ObjectId } from "mongoose";
import userCards from "./api/userCards.js";

dotenv.config();
const app = express();
const allowedOrigins = [
  "http://localhost:5173",
  "http://192.168.1.137:5173",
  "https://cardoon-front.onrender.com",
];
app.use(cors({ origin: allowedOrigins, credentials: true }));
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));
app.use((req, res, next) => {
  next();
});
app.use("/api/cards", cardsRoutes);
app.use("/api/userCards", userCardsRoutes);
app.use("/api/users", usersRoutes);
app.use("/api/mistral", mistralRoutes);
app.use("/api/items", itemsRoutes);
app.get("/api/admin/catchup", async (req, res) => {
  console.log("Catchup endpoint hit kappa");
  // Get all cards from Carole. (UserId : 684835fc6f4fff7090150f30)

  const getAllCardsFromCarole = async () => {
    const user = await User.findById("684835fc6f4fff7090150f30");
    if (!user) {
      console.log("User Carole not found");
      return;
    }
    // const userCards = await UserCard.find({
    //   user: "684835fc6f4fff7090150f30",
    // });
    const userCards = await user.getOutdatedCards();
    //.populate("card");
    return userCards;
  };

  // const revertUserCards = async (cards: UserCard[]) => {
  //   cards.map((userCard) => userCard.card);
  //   const firstCard = cards[0];
  //   console.log(`User Carole has ${cards.length} cards. First card:`);
  //   console.log(firstCard);
  //   const card = await Card.findById(firstCard._id);
  //   if (card) {
  //     const invertedCard = await card.invert();
  //     console.log("Inverted card created:");
  //     console.log(invertedCard);
  //   } else {
  //     console.log("First card not found in database");
  //   }
  // };

  const allCardsFromCarole = await getAllCardsFromCarole();
  // revertUserCards(allCardsFromCarole)
  // This function should interact with your database to get the cards.
  res.status(200).json({
    allCardsFromCarole,
  });
});
app.post("/api/admin/catchup", async (req, res) => {
  console.log("Catchup POST endpoint hit");
  const userCardIdsToDetachFromCarole = [
    "679ccde1d7337b89a0f3dcf5",
    "679ccde1d7337b89a0f3dcf7",
    "679ccde1d7337b89a0f3dcf6",
    "679ccde1d7337b89a0f3dcf9",
    "679ccde1d7337b89a0f3dcf8",
    "67a11af3b78b87a9973228ca",
    "67a1f2e02cab61e9eaf6ac2d",
    "67a1f4d32cab61e9eaf6ac75",
    "67a1f7bb2cab61e9eaf6ac8c",
    "67a1f8952cab61e9eaf6ac94",
    "67a1f9e72cab61e9eaf6ac9c",
    "67a38c6fc1d2d2b788d6cea3",
    "67a3d965ef37bf06d00046a1",
    "67a3e0a528cedb315e2f6dc7",
    "67a3e58f28cedb315e2f6e75",
    "67a66a052489b2dbdb82f3c6",
    "67a66a5b2489b2dbdb82f3ce",
    "67a66a8a2489b2dbdb82f3e6",
    "67a66aac2489b2dbdb82f3ee",
    "67a66ab92489b2dbdb82f3f3",
    "67a917df6d30c979fcbb100c",
    "67a917ff6d30c979fcbb1011",
    "67a918916d30c979fcbb1019",
    "67a918de6d30c979fcbb101e",
    "67a919926d30c979fcbb1023",
    "67a91afa6d30c979fcbb1028",
    "67a91ba96d30c979fcbb102d",
    "67a91bca6d30c979fcbb1035",
    "67a91bf06d30c979fcbb103a",
    "67a91f016d30c979fcbb103f",
    "67a9209b6d30c979fcbb1044",
    "67a922276d30c979fcbb1049",
    "67a9fd38069eda3800265b58",
    "67a9fd92069eda3800265b64",
    "67aa0372069eda3800265b81",
    "67aa048a069eda3800265b86",
    "67aa5133f3c60ca2bda6296a",
    "67aa69ddeb6360e49721f159",
    "67aa6a2feb6360e49721f15e",
    "67aa6a52eb6360e49721f163",
    "67aa6b15eb6360e49721f168",
    "67aa6d05eb6360e49721f16d",
    "67aa70a790b1b3de2ce08b62",
    "67aa70c690b1b3de2ce08b6f",
    "67aa714290b1b3de2ce08b81",
    "67aa716190b1b3de2ce08b86",
    "67aa71d990b1b3de2ce08b8e",
    "67aa73ff90b1b3de2ce08bd5",
    "67aa79f5cc44bba4bad7b4fe",
    "67abad8dbea3aaf16636ac7e",
    "67abb7e3785900afcb189be2",
    "67abd92505eba78a5537af77",
    "67abd92905eba78a5537af7c",
    "67abd93205eba78a5537af81",
    "67abda6b05eba78a5537af86",
    "67ad0357a745979bbd888699",
    "67ad0663a745979bbd8886c5",
    "67ad06aba745979bbd8886f1",
    "67ad07a3a745979bbd888737",
    "67ad07c7a745979bbd88873f",
    "67ad0893a745979bbd88875b",
    "67ad15595e7e7689eaaeaf8e",
    "67ad178e5e7e7689eaaeaf93",
    "67af64783c2065ae13335371",
    "67af820084de954e0b29aeed",
    "67b245d309583f0a57bd1b58",
    "67b24d3e8114594171e1bac0",
    "67b25e0f00ef060f7662e697",
    "67b260ef00ef060f7662e780",
    "67b31267b58821b743cf55fe",
    "67b31b39b58821b743cf5619",
    "67b31b5cb58821b743cf561e",
    "67b334783dd5033cc231f1fa",
    "67b334d73dd5033cc231f1ff",
    "67b35c8917607a6e9dbf8f2f",
    "67b35f5587ffa7b643ed4790",
    "67b3612187ffa7b643ed47b5",
    "67b47352659db35335345b2b",
    "67b475a9659db35335345b39",
    "67b4b88bf57bbc03b00678ac",
    "67c0c9bf4a89f9275f3a20d5",
    "67c0cb614a89f9275f3a2105",
    "67c0cd314a89f9275f3a214d",
    "67c1e48bc5d1ab54d85bf906",
    "67c1e5f8c5d1ab54d85bf90b",
    "67c1eccbc5d1ab54d85bf910",
    "67c2fe1e154062c3763fc801",
    "67c2fe5c154062c3763fc80f",
    "67c301e2154062c3763fc81a",
    "67c302c3154062c3763fc81f",
    "67c309ad9331072b06e14805",
    "67c37da444729c181cc2c99f",
    "67c3826309f2aac3c8311c91",
    "67c487e6f0e2c3336436db09",
    "67c487eff0e2c3336436db0e",
    "67c4881cf0e2c3336436db13",
    "67c4884df0e2c3336436db18",
    "67c48951f0e2c3336436db1d",
    "67c48979f0e2c3336436db22",
    "67c48e53f0e2c3336436dbce",
    "67c48fbff0e2c3336436dbd3",
    "67c49596f0e2c3336436dbe3",
    "67c4e45ef0e2c3336436dc01",
    "67c4e476f0e2c3336436dc06",
    "67c4e482f0e2c3336436dc0b",
    "67c4e51af0e2c3336436dc10",
    "67c8030d1990c770487c2755",
    "67ca29c9235fdad000ddb4ac",
    "67cb4af0e2655c694b6322f3",
    "67cb4c16e2655c694b6322f8",
    "67cb4d64e2655c694b632301",
    "67cb72b0c63fcc82e203f150",
    "67cb73fdc63fcc82e203f155",
    "67cb7688c63fcc82e203f165",
    "67cb76c2c63fcc82e203f16a",
    "67cb7965c63fcc82e203f16f",
    "67cbd882210516e8689fc2a9",
    "67cbd990210516e8689fc30b",
    "67cbdafe210516e8689fc310",
    "67cbdbad210516e8689fc315",
    "67cbdbd4210516e8689fc32c",
    "67cd09a0f3fe552c6997a5f0",
    "67cd0aa3f3fe552c6997a5f5",
    "67cd0fb5f3fe552c6997a5fa",
    "67cd141df3fe552c6997a5ff",
    "67cd16cdf3fe552c6997a604",
    "67cd16f1f3fe552c6997a609",
    "67cd16fbf3fe552c6997a60e",
    "67cd1739f3fe552c6997a613",
    "67cd4cb9a40564d416534fc3",
    "67cd4d68a40564d416534fcb",
    "67cd8858469eca55d6d278bc",
    "67ce1eb07a20214c80d3960a",
    "67cebe082bf959c4df51d571",
    "67cebf0c2bf959c4df51d576",
    "67cec1422bf959c4df51d57b",
    "67cec1582bf959c4df51d580",
    "67ced65ed71189a2fa3a84ec",
    "67ced84cd71189a2fa3a84fa",
    "67cefcb22bf959c4df51d596",
    "67cf003a2bf959c4df51d5f6",
    "67cf004e2bf959c4df51d5fb",
    "67cf03332bf959c4df51d600",
    "67cf03492bf959c4df51d605",
    "67cf04d22bf959c4df51d60a",
    "67cf058c2bf959c4df51d60f",
    "67cf09cf2bf959c4df51d704",
    "67cf17722bf959c4df51d714",
    "67cf497068bb53d995403b34",
    "67cf4e0dc0aaf962eb6462bb",
    "67cf4fcac0aaf962eb6462e2",
    "67cf58b42bf959c4df51d8b1",
    "67cf7dd0204349a8b1838375",
    "67cf8b22204349a8b183838b",
    "67cfa223595881644cc6fa1d",
    "67cfa3c7595881644cc6fa89",
    "67cfa3ca595881644cc6fa8e",
    "67cfa3d0595881644cc6fa93",
    "67cfa3d6595881644cc6fa98",
    "67cfa3d9595881644cc6fa9d",
    "67cfa3db595881644cc6faa2",
    "67cfa3df595881644cc6faa7",
    "67cfa3e2595881644cc6faac",
    "67cfa426595881644cc6fab1",
    "67cfa427595881644cc6fab6",
    "67cfa428595881644cc6fabb",
    "67cfa42c595881644cc6fac0",
    "67cfa434595881644cc6fac5",
    "67cfa435595881644cc6faca",
    "67cfa436595881644cc6facf",
    "67cfa438595881644cc6fad4",
    "67cfa439595881644cc6fad9",
    "67cfa43a595881644cc6fade",
    "67cfa43e595881644cc6fae3",
    "67cfa441595881644cc6fae8",
    "67cfa442595881644cc6faed",
    "67cfa443595881644cc6faf2",
    "67cfa449595881644cc6faf7",
    "67cfa44c595881644cc6fafc",
    "67cfa44d595881644cc6fb01",
    "67cfa44d595881644cc6fb06",
    "67cfa44f595881644cc6fb0b",
    "67cfa452595881644cc6fb10",
    "67cfa454595881644cc6fb15",
    "67cfa455595881644cc6fb1a",
    "67cfa45d595881644cc6fb1f",
    "67cfa467595881644cc6fb24",
    "67cfa489595881644cc6fb29",
    "67cfa499595881644cc6fb2e",
    "67cfa49d595881644cc6fb33",
    "67cfa566595881644cc6fb38",
    "67cfa56d595881644cc6fb3d",
    "67cfa578595881644cc6fb42",
    "67cfa581595881644cc6fb47",
    "67cfa59a595881644cc6fb4c",
    "67cfa5a2595881644cc6fb51",
    "67cfa5a6595881644cc6fb56",
    "67cfa5ab595881644cc6fb5b",
    "67cfa5b5595881644cc6fb60",
    "67cfa5ca595881644cc6fb65",
    "67cfa5e0595881644cc6fb6a",
    "67cfa5e6595881644cc6fb6f",
    "67cfa5ec595881644cc6fb74",
    "67cfa601595881644cc6fb79",
    "67cfad20595881644cc6fbd6",
    "67cfb355595881644cc6fc39",
    "67cfc4e2eb5ce721d7bd815a",
    "67cfc4f3eb5ce721d7bd815f",
    "67cfc4faeb5ce721d7bd8164",
    "67cfc502eb5ce721d7bd8169",
    "67cfc506eb5ce721d7bd816e",
    "67cfc513eb5ce721d7bd8173",
    "67cfc51deb5ce721d7bd8178",
    "67cfc52eeb5ce721d7bd817d",
    "67cfc532eb5ce721d7bd8182",
    "67cfc55aeb5ce721d7bd8187",
    "67cfc568eb5ce721d7bd818c",
    "67cfc578eb5ce721d7bd8191",
    "67cfc5b3eb5ce721d7bd8196",
    "67cfc5c3eb5ce721d7bd819b",
    "67cfc5cdeb5ce721d7bd81a0",
    "67cfc5d2eb5ce721d7bd81a5",
    "67cfc5ddeb5ce721d7bd81aa",
    "67cfc62aeb5ce721d7bd81af",
    "67cfc630eb5ce721d7bd81b4",
    "67cfc647eb5ce721d7bd81b9",
    "67cfc64ceb5ce721d7bd81be",
    "67cfc65ceb5ce721d7bd81c3",
    "67cfc663eb5ce721d7bd81c8",
    "67cfc670eb5ce721d7bd81cd",
    "67cfc683eb5ce721d7bd81d2",
    "67cfc688eb5ce721d7bd81d7",
    "67cfc6bceb5ce721d7bd81dc",
    "67cfc6c2eb5ce721d7bd81e1",
    "67cfc6c5eb5ce721d7bd81e6",
    "67cfc6cbeb5ce721d7bd81eb",
    "67cfc6d1eb5ce721d7bd81f0",
    "67cfc6d6eb5ce721d7bd81f5",
    "67cfc6f2eb5ce721d7bd81fa",
    "67cfc6f6eb5ce721d7bd81ff",
    "67cfc6fceb5ce721d7bd8204",
    "67cfc6feeb5ce721d7bd8209",
    "67cfc702eb5ce721d7bd820e",
    "67cfc709eb5ce721d7bd8213",
    "67cfc746eb5ce721d7bd8218",
    "67cfc74beb5ce721d7bd821d",
    "67cfc750eb5ce721d7bd8222",
    "67cfc756eb5ce721d7bd8227",
    "67cfc777eb5ce721d7bd822c",
    "67cfc781eb5ce721d7bd8231",
    "67cfc784eb5ce721d7bd8236",
    "67cfc78aeb5ce721d7bd823b",
    "67cfc79feb5ce721d7bd8240",
    "67cfc7a4eb5ce721d7bd8245",
    "67cfc7a7eb5ce721d7bd824a",
    "67cfc7aceb5ce721d7bd824f",
    "67cfc7b5eb5ce721d7bd8254",
    "67cfc7b8eb5ce721d7bd8259",
    "67cfc7e1eb5ce721d7bd825e",
    "67cfc7e7eb5ce721d7bd8263",
    "67cfc7ebeb5ce721d7bd8268",
    "67cfc81feb5ce721d7bd826d",
    "67cfc825eb5ce721d7bd8272",
    "67cfc82ceb5ce721d7bd8277",
    "67cfc83deb5ce721d7bd827c",
    "67cfc843eb5ce721d7bd8281",
    "67cfc97feb5ce721d7bd8286",
    "67d43d4c858a6b556230ca21",
    "67d43d4f858a6b556230ca26",
    "67d43d52858a6b556230ca2b",
    "67d43d59858a6b556230ca30",
    "67d43d5c858a6b556230ca35",
    "67d43d66858a6b556230ca3a",
    "67d43d6a858a6b556230ca3f",
    "67d43d70858a6b556230ca44",
    "67d43d7a858a6b556230ca49",
    "67d43d89858a6b556230ca4e",
    "67d43d8c858a6b556230ca53",
    "67d43fe9858a6b556230ca58",
    "67d43fee858a6b556230ca5d",
    "67d43ff1858a6b556230ca62",
    "67d43ff4858a6b556230ca67",
    "67d43ffa858a6b556230ca6c",
    "67d44010858a6b556230ca71",
    "67d442b0858a6b556230ca76",
    "67d442b2858a6b556230ca7b",
    "67d442ba858a6b556230ca80",
    "67d442be858a6b556230ca85",
    "67d442c4858a6b556230ca8a",
    "67d442cd858a6b556230ca8f",
    "67d442d2858a6b556230ca94",
    "67d442f6858a6b556230ca99",
    "67d442f9858a6b556230ca9e",
    "67d442fd858a6b556230caa3",
    "67d44302858a6b556230caa8",
    "67d44305858a6b556230caad",
    "67d44306858a6b556230cab2",
    "67d4430b858a6b556230cab7",
    "67d44a73b0bb0efc33d49838",
    "67d44a73b0bb0efc33d4983d",
    "67d44a7eb0bb0efc33d49842",
    "67d44a8db0bb0efc33d49847",
    "67d44a96b0bb0efc33d4984c",
    "67d589bdd28af324fdb058d9",
    "67d58a53d28af324fdb058e6",
    "67d5e2e72214f83ca0f3ffff",
    "67d60b8ad750925d0335c9a7",
    "67d60b9ed750925d0335c9ac",
    "67d60babd750925d0335c9b6",
    "67d60bbcd750925d0335c9bb",
    "67d60e88d750925d0335c9c0",
    "67d60e9bd750925d0335c9c5",
    "67d60ea1d750925d0335c9ca",
    "67d60eb5d750925d0335c9cf",
    "67d610e0d750925d0335c9d9",
    "67d610fbd750925d0335c9de",
    "67d6117ed750925d0335c9e3",
    "67d611a7d750925d0335c9e8",
    "67d611bed750925d0335c9ed",
    "67d9ee6545ebad56dd7481f6",
    "67d9ee9045ebad56dd748201",
    "67d9ee9345ebad56dd748206",
    "67d9eebd45ebad56dd74820b",
    "67d9eece45ebad56dd748210",
    "67d9eed345ebad56dd748215",
    "67d9eee045ebad56dd74821a",
    "67d9eef245ebad56dd74821f",
    "67d9ef0945ebad56dd748224",
    "67e2501b74549235f5e89a96",
    "67e2534674549235f5e89af8",
    "67e26ee280ae152ca3a454bb",
    "67e2729a80ae152ca3a45515",
    "67e3ecdf040415aa91066996",
    "67e3ecf4040415aa9106699b",
    "67e3ecfc040415aa910669a0",
    "67e3ed03040415aa910669a5",
    "67e3eec5040415aa910669aa",
    "67e3eecc040415aa910669af",
    "67e3f0cc040415aa910669b4",
    "67e3f103040415aa910669b9",
    "67e3f515040415aa910669be",
    "67e411dd040415aa910669c3",
    "67e411e9040415aa910669c8",
    "67e4146f040415aa910669d9",
    "67e41481040415aa910669de",
    "67e41491040415aa910669e3",
    "67e414c7040415aa910669e8",
    "67ea217e360429e0f95a5981",
    "67f4c87c459ac5cfee01a7cd",
    "67f78a86448a7cbd6d884848",
    "67f78c31448a7cbd6d884877",
    "6806ae5f69c9da9bbac9f34a",
    "6806ae9769c9da9bbac9f350",
    "6806aeb869c9da9bbac9f355",
    "6806aedf69c9da9bbac9f35a",
    "6806b11269c9da9bbac9f372",
    "6806b11f69c9da9bbac9f377",
    "6806b2b969c9da9bbac9f37c",
    "6806b30569c9da9bbac9f383",
    "680734dbab122d1aeee9c179",
    "68073501ab122d1aeee9c17e",
    "68073528ab122d1aeee9c183",
    "680735b0ab122d1aeee9c18d",
    "680735f8ab122d1aeee9c192",
    "68073685ab122d1aeee9c1ad",
    "68073abaab122d1aeee9c24f",
    "68073f56ab122d1aeee9c302",
    "68073f69ab122d1aeee9c307",
    "68074177ab122d1aeee9c373",
    "6807443dab122d1aeee9c39b",
    "680777beab122d1aeee9c529",
    "680777cbab122d1aeee9c52e",
    "680777d2ab122d1aeee9c533",
    "680777e2ab122d1aeee9c538",
    "68078287ab122d1aeee9c5fa",
    "680782a0ab122d1aeee9c5ff",
    "68088140ec475cbb470f8b6d",
    "6809fc961a6c766659766640",
    "6809fcb81a6c766659766645",
    "680b27266c3ca369a1b9bf91",
    "680b27376c3ca369a1b9bf96",
    "680b28566c3ca369a1b9bffc",
    "680b28f46c3ca369a1b9c02e",
    "680b29096c3ca369a1b9c033",
    "680b29256c3ca369a1b9c038",
    "680b29486c3ca369a1b9c057",
    "680b29676c3ca369a1b9c05c",
    "680b29706c3ca369a1b9c061",
    "680b5ad402bc6f574b5e1c0b",
    "680bae80ccaeb1c203831c1b",
    "680ca985bfd02973d3bda2f0",
    "680ca98ebfd02973d3bda2f5",
    "680ca996bfd02973d3bda2fa",
    "680cb085bfd02973d3bda41a",
    "680cb08ebfd02973d3bda41f",
    "680cb092bfd02973d3bda424",
    "680cb096bfd02973d3bda429",
    "680cb09cbfd02973d3bda42e",
    "680cb0a6bfd02973d3bda433",
    "680cb102bfd02973d3bda46d",
    "680cb107bfd02973d3bda472",
    "680cb118bfd02973d3bda477",
    "680cd54abfd02973d3bda64b",
    "680cd5babfd02973d3bda650",
    "680cd5dabfd02973d3bda655",
    "680cd5debfd02973d3bda65a",
    "680cd5e2bfd02973d3bda65f",
    "680cd5edbfd02973d3bda664",
    "680cd5f2bfd02973d3bda669",
    "680dbfc65a7fa593f56374b6",
    "680dbfd35a7fa593f56374bc",
    "680dc5115a7fa593f56374f2",
    "680dc51f5a7fa593f56374f8",
    "680f51c3e31e024932805403",
    "680f53b4e31e024932805427",
    "680f53b6e31e02493280542d",
    "680f53bbe31e024932805433",
    "680f5cffe31e0249328054db",
    "680f5d04e31e0249328054e1",
    "680f5d09e31e0249328054e7",
    "680f5d0ce31e0249328054ed",
    "680f5d12e31e0249328054f3",
    "680f86ebe31e02493280577a",
    "680f9a31e31e024932805869",
    "680f9b8fe31e02493280586f",
    "6811a542707a8c3dd81fbada",
    "6817b6dbaa470bfb244f2ecb",
    "6817bdd8aa470bfb244f2ed7",
    "6817c150aa470bfb244f2edd",
    "6817c1aaaa470bfb244f2ee9",
    "6817c70eaa470bfb244f2eef",
    "6817d4feaa470bfb244f2f0f",
    "6817f6e6cde9430ac864fda0",
    "6817f6f0cde9430ac864fda6",
    "6817f6f6cde9430ac864fdac",
    "6817f6f9cde9430ac864fdb2",
    "68184f01cde9430ac8650069",
    "68184f0acde9430ac865006f",
    "68184f25cde9430ac8650075",
    "68184f53cde9430ac865007b",
    "68184f5acde9430ac8650081",
    "68184f62cde9430ac8650087",
    "68184f6dcde9430ac865008d",
    "68184f95cde9430ac865009c",
    "68184fa4cde9430ac86500a2",
    "6818a88ecde9430ac86500c5",
    "6818a90bcde9430ac86500d7",
    "6818ad3ecde9430ac8650103",
    "6818ad47cde9430ac8650109",
    "6818ad53cde9430ac865010f",
    "6818ad5ecde9430ac865011b",
    "6818af83cde9430ac8650133",
    "6818d1c3cde9430ac865023c",
    "6818d1c6cde9430ac8650242",
    "6819e325cde9430ac865032c",
    "6819e3bacde9430ac8650332",
    "6819e3c0cde9430ac8650338",
    "6819e3c7cde9430ac865033e",
    "6819e3c7cde9430ac8650344",
    "6819e3e9cde9430ac865034a",
    "6819e3eecde9430ac8650350",
    "6819e3f3cde9430ac8650356",
    "6819e417cde9430ac865035c",
    "681a8dd3cde9430ac865039b",
    "681be5cacde9430ac86503c8",
    "681be5eccde9430ac86503ce",
    "681be60acde9430ac86503d4",
    "681be60ecde9430ac86503da",
    "681c6a8ceebe857e4ce19aa7",
    "681c74c9eebe857e4ce19ad7",
    "681c74ebeebe857e4ce19add",
    "681c74f0eebe857e4ce19ae3",
    "681c74f2eebe857e4ce19ae9",
    "681c74f7eebe857e4ce19aef",
    "681c74fdeebe857e4ce19af5",
    "681c77c4eebe857e4ce19aff",
    "681c77c7eebe857e4ce19b05",
    "681c77ceeebe857e4ce19b0b",
    "681c77e3eebe857e4ce19b11",
    "681c87eaeebe857e4ce19b3b",
    "681c87efeebe857e4ce19b41",
    "681c87f3eebe857e4ce19b47",
    "681c87f4eebe857e4ce19b4d",
    "681c87f6eebe857e4ce19b53",
    "681c8802eebe857e4ce19b59",
    "681c8807eebe857e4ce19b5f",
    "681c8821eebe857e4ce19b65",
    "681c8897eebe857e4ce19b77",
    "681c8922eebe857e4ce19b7d",
    "681c8923eebe857e4ce19b83",
    "681c892feebe857e4ce19b89",
    "681c894beebe857e4ce19b8f",
    "681c8953eebe857e4ce19b95",
    "681c895aeebe857e4ce19b9b",
    "681c8963eebe857e4ce19ba1",
    "681c896eeebe857e4ce19ba7",
    "681d2d2cb8ac8c6b0f02365c",
    "681db1ccb8ac8c6b0f0236cb",
    "681db1d5b8ac8c6b0f0236d1",
    "681db1e2b8ac8c6b0f0236d7",
    "681db1e8b8ac8c6b0f0236dd",
    "681db1edb8ac8c6b0f0236e3",
    "681db1f8b8ac8c6b0f0236e9",
    "681db203b8ac8c6b0f0236ef",
    "681dc6238282225f73655570",
    "681dc6278282225f73655576",
    "681dc62a8282225f7365557c",
    "681dc62d8282225f73655582",
    "681dc6308282225f73655588",
    "681dc6338282225f7365558e",
    "681dc6368282225f73655594",
    "681dc6378282225f7365559a",
    "681dc63b8282225f736555a0",
    "681dc6408282225f736555a6",
    "681dd655fb72c7655c73fc60",
    "681dd813fb72c7655c73fc84",
    "681de9cbed2a9ed4b9703448",
    "681de9cfed2a9ed4b970344e",
    "681de9d1ed2a9ed4b9703454",
    "681de9d3ed2a9ed4b970345a",
    "681de9d5ed2a9ed4b9703460",
    "681de9d7ed2a9ed4b9703466",
    "681de9e6ed2a9ed4b970346c",
    "681de9e8ed2a9ed4b9703472",
    "681de9f8ed2a9ed4b9703478",
    "681dea01ed2a9ed4b970347e",
    "681dea02ed2a9ed4b9703484",
    "681e2fd24280e7e9ee9c5c61",
    "681e313e4280e7e9ee9c5c7f",
    "681e344c4280e7e9ee9c5c85",
    "681e347a4280e7e9ee9c5c8b",
    "682198dfa08eb2f8d24dc12a",
    "68219914a08eb2f8d24dc130",
    "68219bf2a08eb2f8d24dc1cf",
    "68219c05a08eb2f8d24dc1d5",
    "6821c900a08eb2f8d24dc2ef",
    "6821c91aa08eb2f8d24dc2f5",
    "6821c91ea08eb2f8d24dc2fb",
    "6821c925a08eb2f8d24dc301",
    "68246ea3d1b6fcad68d600cc",
    "68246ea6d1b6fcad68d600d3",
    "68246eb0d1b6fcad68d600da",
    "68247397d1b6fcad68d601ea",
    "6824739bd1b6fcad68d601f1",
    "6824739ed1b6fcad68d601f8",
    "682473a4d1b6fcad68d601ff",
    "682473a5d1b6fcad68d60206",
    "682473a8d1b6fcad68d6020d",
    "682473abd1b6fcad68d60214",
    "682667b1affc80da575c6241",
    "6826aa22affc80da575c62a4",
    "682bf3b994223f7a48d0f8aa",
    "682bf3d594223f7a48d0f8b2",
    "682bf3dd94223f7a48d0f8ba",
    "682c4c7d700b2b1095e14da0",
    "682c4c7e700b2b1095e14da8",
    "682c4c83700b2b1095e14db0",
    "682c4c84700b2b1095e14db8",
    "682c4c87700b2b1095e14dc0",
    "682c4c89700b2b1095e14dc8",
    "682c4c8f700b2b1095e14dd0",
    "682c4d6d700b2b1095e14dd8",
    "682c4d72700b2b1095e14de0",
    "682c4d76700b2b1095e14de8",
    "682c4d7a700b2b1095e14df0",
    "682c4d7b700b2b1095e14df8",
    "682c4d7d700b2b1095e14e00",
    "6830b9b190efa5b731400188",
    "68355a2b010193f52dd5c2ef",
    "68355a41010193f52dd5c2f7",
    "68355a47010193f52dd5c2ff",
    "6845d530010193f52dd5c597",
    "6845d535010193f52dd5c59f",
    "6845d539010193f52dd5c5a7",
    "6845d554010193f52dd5c5af",
    "6845d558010193f52dd5c5b7",
    "6845d55e010193f52dd5c5bf",
    "6845d561010193f52dd5c5c7",
    "6845d583010193f52dd5c5cf",
    "6845d588010193f52dd5c5d7",
    "684be90d82f60ff4b879da44",
    "684dcbb882f60ff4b879da58",
    "686d461f73edea574fa755a0",
    "687f3a3873edea574fa75d0b",
    "6884dd9473edea574fa761d9",
    "68999db373edea574fa763d8",
    "68ad67ae73edea574fa76872",
    "68b2b7b773edea574fa76df1",
    "68b5738f73edea574fa7724d",
    "68b7dbf20502f9b1970f482f",
    "68b7f91b0502f9b1970f4898",
    "68b7f9400502f9b1970f48a0",
    "68b7f94f0502f9b1970f48a8",
    "68be918337982c2b8cf30c2c",
    "68be94da37982c2b8cf30c53",
    "68becc9e37982c2b8cf30c81",
    "68becd1e37982c2b8cf30c89",
    "68becd8237982c2b8cf30ca0",
    "68bece4037982c2b8cf30cad",
    "68becea537982c2b8cf30cb9",
    "68beceb037982c2b8cf30cc1",
    "68becf5e37982c2b8cf30cc9",
    "68becf8337982c2b8cf30cd1",
    "68becfb137982c2b8cf30cef",
    "68becfbf37982c2b8cf30d15",
    "68becfd537982c2b8cf30d2d",
    "68bed02d37982c2b8cf30d8b",
    "68c530a237982c2b8cf31597",
    "68c530b037982c2b8cf3159f",
  ];
  // This function should interact with your database to perform the catch-up procedure.
  // For example, it might create missing UserCards for users based on some criteria.
  res.status(200).json({ message: "Catch-up procedure initiated" });
});

export const errorHandler = (
  err: Error,
  req: Request,
  res: Response,
  next: any
) => {
  console.error(err.stack);
  res
    .status(err.name === "ValidationError" ? 400 : 500)
    .json({ message: "An error occurred", error: err.message });
  return;
};
app.use(errorHandler);
connectDB();

const port = process.env.PORT || 8082;

app.listen(port, () => console.log(`Server running on port ${port}`));
